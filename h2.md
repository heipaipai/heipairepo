# h2 Goat

For the [Haaga-Helia UAS](https://www.haaga-helia.fi/en) spring 2023 course [Information Security](https://terokarvinen.com/2023/information-security-2023/) by [Tero Karvinen](https://terokarvinen.com/).

By Heidi Paimen

Using a Windows 10 OS on a Lenovo Thinkpad Yoga 12.

## Table of Contents

1. [Summarize texts](#summarize)
2. [Sequel](#sequel)
3. [Injected: WebGoat A1 Injection](#webgoat-injection)
4. [Voluntary: SQLZoo](#sqlzoo)
5. [Sources](#sources)


<a name="summarize"></a>
## Summarize texts

### OWASP: [OWASP 10 2021](https://owasp.org/Top10/)

#### [A03:2021-Injection](https://owasp.org/Top10/A03_2021-Injection/)

* About Injections
  * Concept is identical among all interpreters
  * Easiest way to detect vulnerabilities is via source code review
* 33 mapped Common Weakness Enumerations (CWEs) in total
  * CWE-79: Cross-site Scripting
  * CWE-89: SQL Injection
  * CWE-73: External Control of File Name or Path
* Description of a vulnerable application example
  * Data supplied by user is not validated / filtered / sanitized
  * Direct use of dynamic queries / non-parameterized calls without context-aware escaping in the interpreter
  * Object-relational mapping (ORM) search parameters allow use of hostile data within them
  * Dynamic queries / commands / stored procedures allow for containment of structure and hostile data in them
* Most common injections
  * SQL
  * NoSQL
  * OS command
  * Object Relational Mapping (ORM)
  * LDAP
  * Expression Language (EL)
  * Object Graph Navigation Library (OGNL) 
* Prevention
  * Keep data separate from commands and queries!
  * Safe API
  * Positive server-side input validation
  * Interpreter-specific escape syntax use
  * Automated testing of all parameters / headers / URL / cookies / JSON / SOAP / XML data inputs
  * CI/CD pipeline automated testing for introduced injection flaws before deployment
  * Control within queries to prevent mass disclosure of records in case of injection

#### [A05:2021-Security Misconfiguration](https://owasp.org/Top10/A05_2021-Security_Misconfiguration/)

* 20 mapped CWEs in total
  * CWE-16 Configuration
  * CWE-611 Improper Restriction of XML External Entity Reference
* Description of a vulnerable application example
  * Missing security hardening in any part of app stack
  * Improperly configured cloud service permissions
  * Default accounts and passwords enabled and unchanged
  * Overly informative error messages / stack traces revealed to users via error handling
  * Latest security features disabled or not securely configured
  * Security settings in servers / frameworks / libraries / databases etc set to insecure values
  * Security headers / directives not sent by server or set to insecure values
  * Out of date / vulnerable software
* Prevention: secure installation processes
  * Repeatable, automated hardening process in a locked down environment
  * Minimal platform
  * Configurations of security notes / updates / patches / cloud storage permissions reviewed and updated as part of the patch management process
  * Segmented application architecture
  * Send security directives to clients
  * Effectiveness of configurations and settings in all environments verified automatically

#### [A06:2021-Vulnerable and Outdated Components](https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/)

* 3 CWEs mapped in total
  * Doesn't have Common Vulnerability and Exposures (CVEs) mapped to the CWEs
  * CWE-1104: Use of Unmaintained Third-Party Components
* Description of vulnerable systems
  * Any used component, including nested dependencies, version unknown to administration
  * Vulnerable / unsupported / out of date software, including OS, servers, DBMSs, apps, APIs, components, runtime environments and libraries
  * Irregular or nonexistent vulnerability scans
  * Administration not subscribed to security bulletins related to used components
  * Platforms / frameworks / dependencies not fixed or upgraded in due time
  * Compatibility of updated / upgraded / patched libraries not tested
  * Unsecured component configurations
* Prevention by patch management process
  * Remove unused dependencies and any unnecessary features / components / files / documentation
  * Continuous, automated inventory of all components and their dependencies' versions
  * Subscribe to email alerts for used components' security vulnerabilities
  * Obtain components only from official sources and over secure links
  * Prefer signed packages in obtaining components
  * Monitor for unmaintained components / libraries that don't create security patches for older versions - if any found, monitor / detect / protect the issue

### [Darknet Diaries](https://darknetdiaries.com/): [Episode 126: REvil](https://darknetdiaries.com/episode/126/)
* REvil was a ransomware as a service (RaaS), and the group behind, active between April 2019 and January 2022.
* Preceded by a ransomware-turned-to-RaaS GandCrab
  * Ransomware Mechanisms of Action: get into a target company, spread around in inner network, encrypt the victim's machines, demand ransom, if paid, provide a decryption key, if not paid, leak the stolen information
  * GandCrab people learned that it was easier to sell GandCrab as a service to other people ("associates"/clients) who took care of the Cyber Kill Chain steps until delivery and Installation of the malware for a share of the paid ransoms
  * REvil was built straight into a RaaS but was sometimes used independently by the REvil themselves at times
* REvil features
  * Encrypt (& decrypt) machines
  * Locate and delete victim backups
  * Ransom negotiation and means to transfer and launder received Bitcoins into useable money via darknet chats, payment sites etc
  * Steal and leak victim data on Tor website called Happy Blog
  * Use victim's own machines to DDoS the victim and the victim's partners
  * Chooses valid targets by checking the machine language and country settings and not executing on machines that are registered to Commonwealth of Independent States (CIS) members list
* The people behind were Russian-speaking, Russian nationality
  * Unknown: pretty much the early frontman of REvil, originally a guy who posted on underground forums about REvil and gave online interviews, claiming to be part of REvil
* Known victims
  * 16 Aug 2019: Texas government, ransom $2.3 million, didn't pay
  * May 2020: GSM Law, ransom $42 million, result unknown (REvil apologised)
  * 1 Jun 2021: JBS USA, ransom $11 mission, paid the ransom
  * Sol Oriens
  * 2 Jul 2021?: Kaseya (& 1500 of Kaseya customer companies), ransom $70 million, didn't pay
  * Customers of ransomware insurance companies via the insurance company itself
  * 282 companies' data leaked to their site for not paying the ransom
* Endgame
  * Kaseya contacted FBI as soon as they noticed they had been attacked
  * FBI advised Kaseya's responses (did not pay), mapped the affected customers of Kaseya's, did FBI magic, obtained a decryption key and used it to save as many companies as possible
  * All REvil servers go offline
  * 11 Aug 2021?: US Justice Department indicts and releases a photo of Yaroslav Vasinskyi / Robotnik
  * 8 Oct 2021?: Vasinskyi arrested in Poland and extradited to the US
  * US Justice Department seized $6.1 million from Yevgeniy Polyanin and releases his photo
  * Jan 14? 2022: Russian FSB told in press release they arrested 14 members of REvil including alleged ringleader Roman Muromsky, and Andrei Bessonov in Moscow and St. Petersburg, seized millions of Rubles, vehicles and technology; the information can't be verified

### Common Vulnerability and Exposure (CVE): CVE-2022-21587

According to [CVE Program](https://www.cve.org/CVERecord?id=CVE-2022-21587):

* Published & updated: 18 Oct 2022
* Assigner: Oracle
* Affects: Oracle Web Applications Desktop Integrator (WADI) of Oracle E-Business Suite Upload component, versions 12.2.3-12.2.11
* Vulnerability: allows unauthenticated attacker with network access via HTTP to compromise WADI
  * easily exploitable
  * can result in takeover of WADI
* CVSS 3.1 Base Score: 9.8

<a name="sequel"></a>
## a) Sequel

### 0 SELECT basics

### 2 SELECT

<a name="webgoat-injection"></a>
## b) Injected: WebGoat A1 Injection (intro)

<a name="sqlzoo"></a>
## Voluntary: SQLZoo 1

<a name="sources"></a>
## Sources

In order of appearance:

Tasks: [Tero Karvinen: h2 Goat](https://terokarvinen.com/2023/information-security-2023/?f=moodle#h2-goat)

[OWASP 10 2021](https://owasp.org/Top10/)

[Darknet Diaries](https://darknetdiaries.com/)

[The MITRE Corporation: CVE Program](https://www.cve.org/CVERecord?id=CVE-2022-21587)

