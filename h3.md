# h3 Attaaack

For the [Haaga-Helia UAS](https://www.haaga-helia.fi/en) spring 2023 course [Information Security](https://terokarvinen.com/2023/information-security-2023/) by [Tero Karvinen](https://terokarvinen.com/).

Tasks found in [this website](https://terokarvinen.com/2023/information-security-2023/?f=moodle#h3-attaaack).

By Heidi Paimen

Using a Windows 10 OS on a Lenovo Thinkpad Yoga 12.

## Table of Contents

1. [Summarize texts](#summarize)
2. [Answer and reference](#answer-refs)
3. [WebGoat: A3 Sensitive data exposure](#webgoat-a3)
4. [Sources](#sources)


<a name="summarize"></a>
## Summarize texts

### [Costa-Gazc贸n 2021: Practical Threat Intelligence and Data-Driven Threat Hunting Chapter 4: Mapping the Adversary (sans Testing yourself)](https://learning.oreilly.com/library/view/practical-threat-intelligence/9781838556372/B13376_04_Final_SK_ePub.xhtml#_idParaDest-75)

* There is no threat hunting without good threat intelligence
* [MITRE ATT&CK Matrix](https://attack.mitre.org/)
* ATT&CK Framework
  * descriptive model for labeling and studying activities that an attacker can do in order to access and operate inside a target system
  * provides a common taxonomy for adversary behaviours
  * can be used however the user wishes to
  * creation of tactics, techniques, and procedures (TTPs) sets on top of the framework is accepted (encouraged?); user-made TTPs can be contributed to the ATT&CK team
* 14 tactics used by the ATT&CK Framework
  1. Reconnaissance: gathering information about the victim(s)
  2. Resource Development: assessment of attacker resources
  3. Initial Access: how the attacker gets access in the victim environment
  4. Execution: running malicious code inside victim environment
  5. Persistence: how the attacker is able to remain inside the victim environment
  6. Privilege Escalation: elevating attacker's level of access in the victim environment
  7. Defense Evasion: how the attacker evades being detected
  8. Credential Access: stealing legitimate user credentials to promote other attacking interests
  9. Discovery: how the attacker gains information about victim environment constitution
  10. Lateral Movement: moving around in the victim environment
  11. Collection: gathering info from victim environment for later exfiltration
  12. Command and Control: attacker communicates with the victim system
  13. Exfiltration: stealing information while staying undetected
  14. Impact: preventing the victim from accessing the victim system
* Each tactic describes a specific behaviour of the threat actor and has a set of techniques
* [ATT&CK Matrix](https://attack.mitre.org/#)
  * column headers = tactics
  * column cells = techniques
  * behind gray buttons of the cells = sub-techniques
  * technique page pattern is the same in all techniques
  * good for planning blue/red team exercises, studying threat actors, ...
* [ATT&CK Navigator](https://mitre-attack.github.io/attack-navigator/)
  * good for visualizing: a threat actor's modus operandi, behaviour of a specific tool, ...
  * preloads the mapping for the tools & groups on layers that the user can then create, combine, overlap
* Example: Formbook
  * Formbook is an infostealer, a browser-logger software that retrieves authorization and login credentials from a web data form before the information reaches a secure server
  * Credential Access: T1555 Credentials from Password Stores (T1555.03 Credentials from Web Browsers), T1056 Input Capture (T1056.001 Keylogging)
  * Collection: T1056 Input Capture (T1056.001 Keylogging)
  * Collection: T1113 Screen Capture

<a name="answer-refs"></a>
## Answer and reference

In context of [Mitre Att&ck](https://attack.mitre.org/)

### Define tactic

* A specific malevolent behaviour which has a set of techniques ([Costa-Gazc贸n 2021](https://learning.oreilly.com/library/view/practical-threat-intelligence/9781838556372/B13376_04_Final_SK_ePub.xhtml#_idParaDest-75))
* Represents the **WHY** a technique is used; tactic is the objective ([Strom 2018](https://medium.com/mitre-attack/att-ck-101-17074d3bc62))
* For example: 6. Privilege Escalation. The attacker has breached the victim environment defenses, and is now inside the network. However, they only have the credentials of a low-level user they infiltrated with, and this user is not allowed to do much of the things the attacker is interested in. Thus, in order to get access to the interesting stuff, the attacker needs to manipulate their user rights until they're allowed as many rights in the system as they require. This can be done in multiple ways (techniques), but the aim stayst the same.

### Define technique and subtechnique

* Technique: how adversaries interact with systems during an operation ([Strom 2018](https://medium.com/mitre-attack/att-ck-101-17074d3bc62))
  * contains information relevant to understanding how the technique works, the context surrounding events, or artifacts generated by the technique
* Represents the **HOW**, or action, of an attack, or **WHAT** is gained by performing an action ([Strom 2018](https://medium.com/mitre-attack/att-ck-101-17074d3bc62))
* Sub-technique: more specific description of the action (technique)([ATT&CK FAQ](https://attack.mitre.org/resources/faq/))

### Define procedure

* A specific way to implement a specific malevolent technique or sub-technique ([Costa-Gazc贸n 2021](https://learning.oreilly.com/library/view/practical-threat-intelligence/9781838556372/B13376_04_Final_SK_ePub.xhtml#_idParaDest-75))
  * can contain multiple techniques and sub-techniques
* In-the-wild use of techniques ([ATT&CK FAQ](https://attack.mitre.org/resources/faq/))

<a name="webgoat-a3"></a>
## WebGoat: A3 Sensitive data exposure

Began the task 7.2.23 at 16.01.

This task required the use of a packet sniffer.
I didn't know what is a packet sniffer.
A quick search gave me [this website](https://www.kaspersky.com/resource-center/definitions/what-is-a-packet-sniffer),
which called packet sniffers also network or protocol analyzers.
Did this include the built-in network analyzer in web developer tools?
The source didn't tell me that, so I just went and tried the task with the web developer tools.

Opened the web developer tools network analyst and clicked the login button.

![webgoat-a3-insecure-login01](https://user-images.githubusercontent.com/55014633/217267607-5defb6b6-563f-4e0c-a35e-b6df4e008cca.png)

Well, that was easy.
I entered the username and password.

![webgoat-a3-insecure-login02](https://user-images.githubusercontent.com/55014633/217267920-11d4d044-89ef-4d31-927f-3a0cc2bafdb6.png)

That was it?
This seemed a bit suspicious, but yeah, apparently that was it.

Ended task 7.2.23 at 16.10.

<a name="sources"></a>
## Sources

In order of appearance:

Tasks: [Tero Karvinen: h3 Attaaack](https://terokarvinen.com/2023/information-security-2023/?f=moodle#h3-attaaack)

[Costa-Gazc贸n 2021: Practical Threat Intelligence and Data-Driven Threat Hunting Chapter 4: Mapping the Adversary (NOTE: Via O'Reilly Learning)](https://learning.oreilly.com/library/view/practical-threat-intelligence/9781838556372/B13376_04_Final_SK_ePub.xhtml#_idParaDest-75)

[Mitre Att&ck](https://attack.mitre.org/)

[Strom, B., 21.9.2018: ATT&CK 101](https://medium.com/mitre-attack/att-ck-101-17074d3bc62)

